<html>
  <head>
    <!-- leaflet -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  
    <!-- deck.gl standalone bundle -->
    <script src="https://unpkg.com/deck.gl@^8.8.0/dist.min.js"></script>
    <!-- deck.gl-leaflet -->
    <script src="https://unpkg.com/deck.gl-leaflet@1.2.1/dist/deck.gl-leaflet.min.js"></script>

    <style>
      #map {
        position: absolute;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
      }
/* .leaflet-layer,
.leaflet-control-zoom-in,
.leaflet-control-zoom-out,
.leaflet-control-attribution {
  filter: invert(100%) hue-rotate(180deg) brightness(95%) contrast(90%);
} */

/*Legend specific*/
.legend {
  padding: 6px 8px;
  font: 14px Arial, Helvetica, sans-serif;
  background: white;
  background: rgba(255, 255, 255, 0.8);
  /*box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);*/
  /*border-radius: 5px;*/
  line-height: 24px;
  color: #555;
}
.legend h4 {
  text-align: center;
  font-size: 16px;
  margin: 2px 12px 8px;
  color: #777;
}

.legend span {
  position: relative;
  bottom: 3px;
}

.legend i {
  width: 18px;
  height: 18px;
  float: left;
  margin: 0 8px 0 0;
  opacity: 0.7;
}

.legend i.icon {
  background-size: 18px;
  background-color: rgba(255, 255, 255, 1);
}
    </style>
  </head>

  <body>
    <div id="map"></div>
  </body>

  <script type="text/javascript">

const test_url =
  'N00000897.geojson';

  const map = L.map(document.getElementById('map'), {
  center: [54.6, -6.5],
  zoom: 9,
});
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
}).addTo(map);

// Colours taken from MetColorBrewer Tam (colourblind safe)
const opacity = 150;
const colours = {15: [254, 203, 28, opacity], 30: [253, 105, 12, opacity], 45: [191, 0, 23, opacity], 60: [85, 0, 77, opacity]}

/*Legend specific*/
var legend = L.control({ position: "bottomleft" });

legend.onAdd = function(map) {
  var div = L.DomUtil.create("div", "legend");
  div.innerHTML += "<h4>Area accessible in:</h4>";
  div.innerHTML += '<i style="background: rgb('.concat(colours['15'][0], ', ', colours['15'][1], ', ', colours['15'][2], ')"></i><span>15 minutes</span><br>');
  div.innerHTML += '<i style="background: rgb('.concat(colours['30'][0], ', ', colours['30'][1], ', ', colours['30'][2], ')"></i><span>30 minutes</span><br>');
  div.innerHTML += '<i style="background: rgb('.concat(colours['45'][0], ', ', colours['45'][1], ', ', colours['45'][2], ')"></i><span>45 minutes</span><br>');;
  div.innerHTML += '<i style="background: rgb('.concat(colours['60'][0], ', ', colours['60'][1], ', ', colours['60'][2], ')"></i><span>60 minutes</span><br>');;

  return div;
};

legend.addTo(map);

fetch(test_url)
.then(res => res.json())
.then(out => {
    out.features.sort((a,b) => b.properties['Travel Minutes'] - a.properties['Travel Minutes']);
    const deckLayer = new DeckGlLeaflet.LeafletLayer({
    views: [
        new deck.MapView({
        repeat: true
        })
    ],
    layers: [
        new deck.GeoJsonLayer({
            id: 'isochrones',
            data: out,
            // Styles
            filled: true,
            getFillColor: f => colours[f.properties['Travel Minutes']]
        }),
    ],
    });
    map.addLayer(deckLayer);

    const featureGroup = L.featureGroup();
    const marker = L.marker([out.features[0].properties.iso_centre_Y, out.features[0].properties.iso_centre_X], title='Hi');
    marker.bindTooltip(out.features[0].properties.SA2011).openTooltip();
    featureGroup.addLayer(marker);
    map.addLayer(featureGroup);
}
)
.catch(err => { throw err });



  </script>
</html>